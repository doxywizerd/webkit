<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Protocol Buffers - Google&#39;s data interchange format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Protocol Buffers - <a class="el" href="namespace_google.html">Google</a>'s data interchange format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/google/protobuf"></a></p>
<p>Copyright 2008 <a class="el" href="namespace_google.html">Google</a> Inc.</p>
<p>This directory contains the Java Protocol Buffers Nano runtime library.</p>
<h2>Installation - With Maven </h2>
<p><a class="el" href="protocol_the-p.html">The</a> Protocol Buffers build is managed using Maven. If you would rather build without Maven, see below.</p>
<p>1) Install Apache Maven if you don't have it: </p><pre class="fragment"> http://maven.apache.org/
</pre><p>2) Build the C++ code, or obtain a binary distribution of protoc. If you install a binary distribution, make sure that it is the same version as this package. If in doubt, run:</p>
<p>$ protoc &ndash;version</p>
<p>You will need to place the protoc executable in ../src. (If you built it yourself, it should already be there.)</p>
<p>3) Run the tests: </p><pre class="fragment"> $ mvn test
</pre><p>If some tests fail, this library may not work correctly on your system. Continue at your own risk.</p>
<p>4) Install the library into your Maven repository: </p><pre class="fragment"> $ mvn install
</pre><p>5) If you do not use Maven to manage your own build, you can build a .jar file to use:</p>
<p>$ mvn package</p>
<p><a class="el" href="protocol_the-p.html">The</a> .jar will be placed in the "target" directory.</p>
<h2>Installation - Without Maven </h2>
<p>If you would rather not install Maven to build the library, you may follow these instructions instead. Note that these instructions skip running unit tests.</p>
<p>1) Build the C++ code, or obtain a binary distribution of protoc. If you install a binary distribution, make sure that it is the same version as this package. If in doubt, run:</p>
<p>$ protoc &ndash;version</p>
<p>If you built the C++ code without installing, the compiler binary should be located in ../src.</p>
<p>2) Invoke protoc to build DescriptorProtos.java: </p><pre class="fragment"> $ protoc --java_out=src/main/java -I../src \
     ../src/google/protobuf/descriptor.proto
</pre><p>3) Compile the code in src/main/java using whatever means you prefer.</p>
<p>4) Install the classes wherever you prefer.</p>
<h2>Nano version </h2>
<p>JavaNano is a special code generator and runtime library designed specially for resource-restricted systems, like Android. It is very resource-friendly in both the amount of code and the runtime overhead. Here is an overview of JavaNano features compared with the official Java protobuf:</p>
<ul>
<li>No descriptors or message builders.</li>
<li>All messages are mutable; fields are public Java fields.</li>
<li>For optional fields only, encapsulation behind setter/getter/hazzer/ clearer functions is opt-in, which provide proper 'has' state support.</li>
<li>For proto2, if not opted in, has state (field presence) is not available. Serialization outputs all fields not equal to their defaults (see important implications below). <a class="el" href="protocol_the-p.html">The</a> behavior is consistent with proto3 semantics.</li>
<li>Required fields (proto2 only) are always serialized.</li>
<li>Enum constants are integers; protection against invalid values only when parsing from the wire.</li>
<li>Enum constants can be generated into container interfaces bearing the enum's name (so the referencing code is in Java style).</li>
<li>CodedInputByteBufferNano can only take byte[] (not InputStream).</li>
<li>Similarly CodedOutputByteBufferNano can only write to byte[].</li>
<li>Repeated fields are in arrays, not ArrayList or Vector. Null array elements are allowed and silently ignored.</li>
<li>Full support for serializing/deserializing repeated packed fields.</li>
<li>Support extensions (in proto2).</li>
<li>Unset messages/groups are null, not an immutable empty default instance.</li>
<li>toByteArray(...) and mergeFrom(...) are now static functions of MessageNano.</li>
<li><a class="el" href="protocol_the-p.html">The</a> 'bytes' type translates to the Java type byte[].</li>
</ul>
<p><a class="el" href="protocol_the-p.html">The</a> generated messages are not thread-safe for writes, but may be used simultaneously from multiple threads in a read-only manner. In other words, an appropriate synchronization mechanism (such as a ReadWriteLock) must be used to ensure that a message, its ancestors, and descendants are not accessed by any other threads while the message is being modified. Field reads, getter methods (but not getExtension(...)), toByteArray(...), writeTo(...), getCachedSize(), and getSerializedSize() are all considered read-only operations.</p>
<p>IMPORTANT: If you have fields with defaults and opt out of accessors</p>
<p>How fields with defaults are serialized has changed. Because we don't keep "has" state, any field equal to its default is assumed to be not set and therefore is not serialized. Consider the situation where we change the default value of a field. Senders compiled against an older version of the proto continue to match against the old default, and don't send values to the receiver even though the receiver assumes the new default value. Therefore, think carefully about the implications of changing the default value. Alternatively, turn on accessors and enjoy the benefit of the explicit has() checks.</p>
<p>IMPORTANT: If you have "bytes" fields with non-empty defaults</p>
<p>Because the byte buffer is now of mutable type byte[], the default static final cannot be exposed through a public field. Each time a message's constructor or <a class="el" href="complexity_measures_8m.html#aebfdce4f6cc7241ba38924f77a12e7cf">clear()</a> function is called, the default value (kept in a private byte[]) is cloned. This causes a small memory penalty. This is not a problem if the field has no default or is an empty default.</p>
<h2>Nano <a class="el" href="class_generator.html">Generator</a> options </h2>
<div class="fragment"><div class="line">java_package           -&gt; &lt;file-name&gt;|&lt;package-name&gt;</div><div class="line">java_outer_classname   -&gt; &lt;file-name&gt;|&lt;package-name&gt;</div><div class="line">java_multiple_files    -&gt; true or false</div><div class="line">java_nano_generate_has -&gt; true or false [DEPRECATED]</div><div class="line">optional_field_style   -&gt; default or accessors</div><div class="line">enum_style             -&gt; c or java</div><div class="line">ignore_services        -&gt; true or false</div><div class="line">parcelable_messages    -&gt; true or false</div><div class="line">generate_intdefs       -&gt; true or false</div></div><!-- fragment --><p><b>java_package=&lt;file-name&gt;|&lt;package-name&gt;</b> (no default)</p>
<p>This allows overriding the 'java_package' option value for the given file from the command line. Use multiple java_package options to override the option for multiple files. <a class="el" href="protocol_the-p.html">The</a> final Java package for each file is the value of this command line option if present, or the value of the same option defined in the file if present, or the proto package if present, or the default Java package.</p>
<p><b>java_outer_classname=&lt;file-name&gt;|&lt;outer-classname&gt;</b> (no default)</p>
<p>This allows overriding the 'java_outer_classname' option for the given file from the command line. Use multiple java_outer_classname options to override the option for multiple files. <a class="el" href="protocol_the-p.html">The</a> final Java outer class name for each file is the value of this command line option if present, or the value of the same option defined in the file if present, or the file name converted to CamelCase. This outer class will nest all classes and integer constants generated from file-scope messages and enums.</p>
<p><b>java_multiple_files={true,false}</b> (no default)</p>
<p>This allows overriding the 'java_multiple_files' option in all source files and their imported files from the command line. <a class="el" href="protocol_the-p.html">The</a> final value of this option for each file is the value defined in this command line option, or the value of the same option defined in the file if present, or false. This specifies whether to generate package-level classes for the file-scope messages in the same Java package as the outer class (instead of nested classes in the outer class). File-scope enum constants are still generated as integer constants in the outer class. This affects the fully qualified references in the Java code. NOTE: because the command line option overrides the value for all files and their imported files, using this option inconsistently may result in incorrect references to the imported messages and enum constants.</p>
<p><b>java_nano_generate_has={true,false}</b> (default: false)</p>
<p>DEPRECATED. Use optional_field_style=accessors.</p>
<p>If true, generates a public boolean variable has&lt;fieldname&gt; accompanying each optional or required field (not present for repeated fields, groups or messages). It is set to false initially and upon <a class="el" href="complexity_measures_8m.html#aebfdce4f6cc7241ba38924f77a12e7cf">clear()</a>. If parseFrom(...) reads the field from the wire, it is set to true. This is a way for clients to inspect the "has" value upon parse. If it is set to true, writeTo(...) will ALWAYS output that field (even if field value is equal to its default).</p>
<p>IMPORTANT: This option costs an extra 4 bytes per primitive field in the message. Think carefully about whether you really need this. In many cases reading the default works and determining whether the field was received over the wire is irrelevant.</p>
<p><b>optional_field_style={default,accessors,reftypes}</b> (default: default)</p>
<p>Defines the style of the generated code for fields.</p>
<ul>
<li>default</li>
</ul>
<p>In the default style, optional fields translate into public mutable Java fields, and the serialization process is as discussed in the "IMPORTANT" section above.</p>
<ul>
<li>accessors</li>
</ul>
<p>When set to 'accessors', each optional field is encapsulated behind 4 accessors, namely get&lt;fieldname&gt;(), set&lt;fieldname&gt;(), has&lt;fieldname&gt;() and clear&lt;fieldname&gt;() methods, with the standard semantics. <a class="el" href="protocol_the-p.html">The</a> hazzer's return value determines whether a field is serialized, so this style is useful when you need to serialize a field with the default value, or check if a field has been explicitly set to its default value from the wire.</p>
<p>In the 'accessors' style, required and nested message fields are still translated to one public mutable Java field each, repeated fields are still translated to arrays. No accessors are generated for them.</p>
<p>IMPORTANT: When using the 'accessors' style, ProGuard should always be enabled with optimization (don't use -dontoptimize) and allowing access modification (use -allowaccessmodification). This removes the unused accessors and maybe inline the rest at the call sites, reducing the final code size. TODO(maxtroy): find ProGuard config that would work the best.</p>
<ul>
<li>reftypes</li>
</ul>
<p>When set to 'reftypes', each proto field is generated as a public Java field. For primitive types, these fields use the Java reference types such as java.lang.Integer instead of primitive types such as int.</p>
<p>In the 'reftypes' style, fields are initialized to null (or empty arrays for repeated fields), and their default values are not available. They are serialized over the wire based on equality to null.</p>
<p><a class="el" href="protocol_the-p.html">The</a> 'reftypes' mode has some additional cost due to autoboxing and usage of reference types. In practice, many boxed types are cached, and so don't result in object creation. However, references do take slightly more memory than primitives.</p>
<p><a class="el" href="protocol_the-p.html">The</a> 'reftypes' mode is useful when you want to be able to serialize fields with default values, or check if a field has been explicitly set to the default over the wire without paying the extra method cost of the 'accessors' mode.</p>
<p>Note that if you attempt to write null to a required field in the reftypes mode, serialization of the proto will cause a NullPointerException. This is an intentional indicator that you must set required fields.</p>
<p>NOTE optional_field_style=accessors or reftypes cannot be used together with java_nano_generate_has=true. If you need the 'has' flag for any required field (you have no reason to), you can only use java_nano_generate_has=true.</p>
<p><b>enum_style={c,java}</b> (default: c)</p>
<p>Defines where to put the int constants generated from enum members.</p>
<ul>
<li>c</li>
</ul>
<p>Use C-style, so the enum constants are available at the scope where the enum is defined. <a class="el" href="struct_a.html">A</a> file-scope enum's members are referenced like 'FileOuterClass.ENUM_VALUE'; a message-scope enum's members are referenced as 'Message.ENUM_VALUE'. <a class="el" href="protocol_the-p.html">The</a> enum name is unavailable. This complies with the Micro code generator's behavior.</p>
<ul>
<li>java</li>
</ul>
<p>Use Java-style, so the enum constants are available under the enum name and referenced like 'EnumName.ENUM_VALUE' (they are still int constants). <a class="el" href="protocol_the-p.html">The</a> enum name becomes the name of a public interface, at the scope where the enum is defined. If the enum is file-scope and the java_multiple_files option is on, the interface will be defined in its own file. To reduce code size, this interface should not be implemented and ProGuard shrinking should be used, so after the Java compiler inlines all referenced enum constants into the call sites, the interface remains unused and can be removed by ProGuard.</p>
<p><b>ignore_services={true,false}</b> (default: false)</p>
<p>Skips services definitions.</p>
<p>Nano doesn't support services. By default, if a service is defined it will generate a compilation error. If this flag is set to true, services will be silently ignored, instead.</p>
<p><b>parcelable_messages={true,false}</b> (default: false)</p>
<p>Android-specific option to generate Parcelable messages.</p>
<p><b>generate_intdefs={true,false}</b> (default: false) Android-specific option to generate  annotations for enums.</p>
<p>If turned on, an '' annotation (a public </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
