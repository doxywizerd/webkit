<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Deprecated Builds</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespace_deprecated.html">Deprecated</a> Builds </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Older documentation on build configs which are no longer supported.</p>
<h2>Pre-requisites</h2>
<p>You'll need to have depot tools installed: <a href="https://www.chromium.org/developers/how-tos/install-depot-tools">https://www.chromium.org/developers/how-tos/install-depot-tools</a> Refer to chromium instructions for each platform for other prerequisites.</p>
<h2>Getting the Code</h2>
<p>Create a working directory, enter it, and run: </p><pre class="fragment">gclient config https://chromium.googlesource.com/libyuv/libyuv
gclient sync
</pre><p>Then you'll get a .gclient file like: </p><pre class="fragment">solutions = [
  { "name"        : "libyuv",
    "url"         : "https://chromium.googlesource.com/libyuv/libyuv",
    "deps_file"   : "DEPS",
    "managed"     : True,
    "custom_deps" : {
    },
    "safesync_url": "",
  },
];
</pre><p>For iOS add `;target_os=['ios'];<code>to your OSX .gclient and run</code>GYP_DEFINES="OS=ios" gclient sync.`</p>
<p>Browse the Git reprository: <a href="https://chromium.googlesource.com/libyuv/libyuv/+/master">https://chromium.googlesource.com/libyuv/libyuv/+/master</a></p>
<h3>Android</h3>
<p>For Android add `;target_os=['android'];` to your Linux .gclient</p>
<pre class="fragment">solutions = [
  { "name"        : "libyuv",
    "url"         : "https://chromium.googlesource.com/libyuv/libyuv",
    "deps_file"   : "DEPS",
    "managed"     : True,
    "custom_deps" : {
    },
    "safesync_url": "",
  },
];
target_os = ["android", "unix"];
</pre><p>Then run: </p><pre class="fragment">export GYP_DEFINES="OS=android"
gclient sync
</pre><p>Caveat: Theres an error with <a class="el" href="namespace_google.html">Google</a> Play services updates. If you get the error "Your version of the Google Play services library is not up to date", run the following: </p><pre class="fragment">cd chromium/src
./build/android/play_services/update.py download
cd ../..
</pre><p>For Windows the gclient sync must be done from an Administrator command prompt.</p>
<p><a class="el" href="protocol_the-p.html">The</a> sync will generate native build files for your environment using gyp (Windows: Visual Studio, OSX: XCode, Linux: make). This generation can also be forced manually: <code>gclient runhooks</code></p>
<p>To get just the source (not buildable): </p><pre class="fragment">git clone https://chromium.googlesource.com/libyuv/libyuv
</pre><h2>Building the Library and Unittests</h2>
<h3>Windows</h3>
<pre class="fragment">set GYP_DEFINES=target_arch=ia32
call python gyp_libyuv -fninja -G msvs_version=2013
ninja -j7 -C out\Release
ninja -j7 -C out\Debug

set GYP_DEFINES=target_arch=x64
call python gyp_libyuv -fninja -G msvs_version=2013
ninja -C out\Debug_x64
ninja -C out\Release_x64
</pre><h4>Building with clangcl</h4>
<p>set GYP_DEFINES=clang=1 target_arch=ia32 call python tools\clang\scripts\update.py call python <a class="el" href="namespacegyp__libyuv.html">gyp_libyuv</a> -fninja libyuv_test.gyp ninja -C out ninja -C out</p>
<h3>OSX</h3>
<p>Clang 64 bit shown. Remove <code>clang=1</code> for GCC and change x64 to ia32 for 32 bit. </p><pre class="fragment">GYP_DEFINES="clang=1 target_arch=x64" ./gyp_libyuv
ninja -j7 -C out/Debug
ninja -j7 -C out/Release

GYP_DEFINES="clang=1 target_arch=ia32" ./gyp_libyuv
ninja -j7 -C out/Debug
ninja -j7 -C out/Release
</pre><h3>iOS</h3>
<p><a href="http://www.chromium.org/developers/how-tos/build-instructions-ios">http://www.chromium.org/developers/how-tos/build-instructions-ios</a></p>
<p>Add to .gclient last line: `target_os=['ios'];`</p>
<p>armv7 </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=armv7 target_subarch=arm32" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>arm64 </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=arm64 target_subarch=arm64" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>both armv7 and arm64 (fat) </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=armv7 target_subarch=both" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>simulator </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=ia32 target_subarch=arm32" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_sim" ./gyp_libyuv
ninja -j7 -C out_sim/Debug-iphonesimulator libyuv_unittest
ninja -j7 -C out_sim/Release-iphonesimulator libyuv_unittest
</pre><h3>Android</h3>
<p><a href="https://code.google.com/p/chromium/wiki/AndroidBuildInstructions">https://code.google.com/p/chromium/wiki/AndroidBuildInstructions</a></p>
<p>Add to .gclient last line: `target_os=['android'];`</p>
<p>armv7 </p><pre class="fragment">GYP_DEFINES="OS=android" GYP_CROSSCOMPILE=1 ./gyp_libyuv
ninja -j7 -C out/Debug yuv_unittest_apk
ninja -j7 -C out/Release yuv_unittest_apk
</pre><p>arm64 </p><pre class="fragment">GYP_DEFINES="OS=android target_arch=arm64 target_subarch=arm64" GYP_CROSSCOMPILE=1 ./gyp_libyuv
ninja -j7 -C out/Debug yuv_unittest_apk
ninja -j7 -C out/Release yuv_unittest_apk
</pre><p>ia32 </p><pre class="fragment">GYP_DEFINES="OS=android target_arch=ia32" GYP_CROSSCOMPILE=1 ./gyp_libyuv
ninja -j7 -C out/Debug yuv_unittest_apk
ninja -j7 -C out/Release yuv_unittest_apk

GYP_DEFINES="OS=android target_arch=ia32 android_full_debug=1" GYP_CROSSCOMPILE=1 ./gyp_libyuv
ninja -j7 -C out/Debug yuv_unittest_apk
</pre><p>mipsel </p><pre class="fragment">GYP_DEFINES="OS=android target_arch=mipsel" GYP_CROSSCOMPILE=1 ./gyp_libyuv
ninja -j7 -C out/Debug yuv_unittest_apk
ninja -j7 -C out/Release yuv_unittest_apk
</pre><p>arm32 disassembly: </p><pre class="fragment">third_party/android_tools/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-objdump -d out/Release/obj/source/libyuv.row_neon.o
</pre><p>arm64 disassembly: </p><pre class="fragment">third_party/android_tools/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/linux-x86_64/bin/aarch64-linux-android-objdump -d out/Release/obj/source/libyuv.row_neon64.o
</pre><p>Running tests: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=*
</pre><p>Running test as benchmark: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=* -a "--libyuv_width=1280 --libyuv_height=720 --libyuv_repeat=999 --libyuv_flags=-1"
</pre><p>Running test with <a class="el" href="class_c.html">C</a> code: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=* -a "--libyuv_width=1280 --libyuv_height=720 --libyuv_repeat=999 --libyuv_flags=1 --libyuv_cpu_info=1"
</pre><h4>Building with GN</h4>
<pre class="fragment">gn gen out/Release "--args=is_debug=false target_cpu=\"x86\""
gn gen out/Debug "--args=is_debug=true target_cpu=\"x86\""
ninja -C out/Release
ninja -C out/Debug
</pre><h3>Building Offical with GN</h3>
<pre class="fragment">gn gen out/Official "--args=is_debug=false is_official_build=true is_chrome_branded=true"
ninja -C out/Official
</pre><h4>Building mips with GN</h4>
<p>mipsel gn gen out/Default "--args=is_debug=false target_cpu=\"mipsel" target_os = "android" mips_arch_variant = "r6" mips_use_msa = true is_component_build = true is_clang = false" ninja -C out/Default</p>
<p>mips64el gn gen out/Default "--args=is_debug=false target_cpu=\"mips64el" target_os = "android" mips_arch_variant = "r6" mips_use_msa = true is_component_build = true is_clang = false" ninja -C out/Default</p>
<h3>Linux</h3>
<pre class="fragment">GYP_DEFINES="target_arch=x64" ./gyp_libyuv
ninja -j7 -C out/Debug
ninja -j7 -C out/Release

GYP_DEFINES="target_arch=ia32" ./gyp_libyuv
ninja -j7 -C out/Debug
ninja -j7 -C out/Release
</pre><h4>CentOS</h4>
<p>On CentOS 32 bit the following work around allows a sync: </p><pre class="fragment">export GYP_DEFINES="host_arch=ia32"
gclient sync
</pre><h3>Windows Shared Library</h3>
<p>Modify libyuv.gyp from 'static_library' to 'shared_library', and add 'LIBYUV_BUILDING_SHARED_LIBRARY' to 'defines'. </p><pre class="fragment">gclient runhooks
</pre><p>After this command follow the building the library instructions above.</p>
<p>If you get a compile error for atlthunk.lib on Windows, read <a href="http://www.chromium.org/developers/how-tos/build-instructions-windows">http://www.chromium.org/developers/how-tos/build-instructions-windows</a></p>
<h3>Build targets</h3>
<pre class="fragment">ninja -C out/Debug libyuv
ninja -C out/Debug libyuv_unittest
ninja -C out/Debug compare
ninja -C out/Debug convert
ninja -C out/Debug psnr
ninja -C out/Debug cpuid
</pre><h2>Building the Library with make</h2>
<h3>Linux</h3>
<pre class="fragment">make -j7 V=1 -f linux.mk
make -j7 V=1 -f linux.mk clean
make -j7 V=1 -f linux.mk CXX=clang++
</pre><h2>Building the Library with cmake</h2>
<p>Install cmake: <a href="http://www.cmake.org/">http://www.cmake.org/</a></p>
<p>Default debug build: </p><pre class="fragment">mkdir out
cd out
cmake ..
cmake --build .
</pre><p>Release build/install </p><pre class="fragment">mkdir out
cd out
cmake -DCMAKE_INSTALL_PREFIX="/usr/lib" -DCMAKE_BUILD_TYPE="Release" ..
cmake --build . --config Release
sudo cmake --build . --target install --config Release
</pre><h3>Windows 8 Phone</h3>
<p>Pre-requisite:</p>
<ul>
<li>Install Visual Studio 2012 and Arm to your environment.<br />
</li>
</ul>
<p>Then: </p><pre class="fragment">call "c:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\bin\x86_arm\vcvarsx86_arm.bat"
</pre><p>or with Visual Studio 2013: </p><pre class="fragment">call "c:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\bin\x86_arm\vcvarsx86_arm.bat"
nmake /f winarm.mk clean
nmake /f winarm.mk
</pre><h3>Windows Shared Library</h3>
<p>Modify libyuv.gyp from 'static_library' to 'shared_library', and add 'LIBYUV_BUILDING_SHARED_LIBRARY' to 'defines'. Then run this. </p><pre class="fragment">gclient runhooks
</pre><p>After this command follow the building the library instructions above.</p>
<p>If you get a compile error for atlthunk.lib on Windows, read <a href="http://www.chromium.org/developers/how-tos/build-instructions-windows">http://www.chromium.org/developers/how-tos/build-instructions-windows</a></p>
<h3>64 bit Windows</h3>
<pre class="fragment">set GYP_DEFINES=target_arch=x64
gclient runhooks V=1
</pre><h3>ARM Linux</h3>
<pre class="fragment">export GYP_DEFINES="target_arch=arm"
export CROSSTOOL=`&lt;path&gt;`/arm-none-linux-gnueabi
export CXX=$CROSSTOOL-g++
export CC=$CROSSTOOL-gcc
export AR=$CROSSTOOL-ar
export AS=$CROSSTOOL-as
export RANLIB=$CROSSTOOL-ranlib
gclient runhooks
</pre><h2>Running Unittests</h2>
<h3>Windows</h3>
<pre class="fragment">out\Release\libyuv_unittest.exe --gtest_catch_exceptions=0 --gtest_filter="*"
</pre><h3>OSX</h3>
<pre class="fragment">out/Release/libyuv_unittest --gtest_filter="*"
</pre><h3>Linux</h3>
<pre class="fragment">out/Release/libyuv_unittest --gtest_filter="*"
</pre><p>Replace &ndash;gtest_filter="*" with specific unittest to run. May include wildcards. e.g. </p><pre class="fragment">out/Release/libyuv_unittest --gtest_filter=libyuvTest.I420ToARGB_Opt
</pre><h2>CPU Emulator tools</h2>
<h3>Intel SDE (Software Development Emulator)</h3>
<p>Pre-requisite: Install IntelSDE for Windows: <a href="http://software.intel.com/en-us/articles/intel-software-development-emulator">http://software.intel.com/en-us/articles/intel-software-development-emulator</a></p>
<p>Then run: </p><pre class="fragment">c:\intelsde\sde -hsw -- out\release\libyuv_unittest.exe --gtest_filter=*
</pre><h2>Memory tools</h2>
<h3>Running Dr Memory memcheck for Windows</h3>
<p>Pre-requisite: Install Dr Memory for Windows and add it to your path: <a href="http://www.drmemory.org/docs/page_install_windows.html">http://www.drmemory.org/docs/page_install_windows.html</a> </p><pre class="fragment">set GYP_DEFINES=build_for_tool=drmemory target_arch=ia32
call python gyp_libyuv -fninja -G msvs_version=2013
ninja -C out\Debug
drmemory out\Debug\libyuv_unittest.exe --gtest_catch_exceptions=0 --gtest_filter=*
</pre><h3>Running UBSan</h3>
<p>See Chromium instructions for sanitizers: <a href="https://www.chromium.org/developers/testing/undefinedbehaviorsanitizer">https://www.chromium.org/developers/testing/undefinedbehaviorsanitizer</a></p>
<p>Sanitizers available: TSan, MSan, ASan, UBSan, LSan </p><pre class="fragment">GYP_DEFINES='ubsan=1' gclient runhooks
ninja -C out/Release
</pre><h3>Running Valgrind memcheck</h3>
<p>Memory errors and race conditions can be found by running tests under special memory tools. <a href="http://valgrind.org">Valgrind</a> is an instrumentation framework for building dynamic analysis tools. Various tests and profilers are built upon it to find memory handling errors and memory leaks, for instance.</p>
<pre class="fragment">solutions = [
  { "name"        : "libyuv",
    "url"         : "https://chromium.googlesource.com/libyuv/libyuv",
    "deps_file"   : "DEPS",
    "managed"     : True,
    "custom_deps" : {
       "libyuv/chromium/src/third_party/valgrind": "https://chromium.googlesource.com/chromium/deps/valgrind/binaries",
    },
    "safesync_url": "",
  },
]
</pre><p>Then run: </p><pre class="fragment">GYP_DEFINES="clang=0 target_arch=x64 build_for_tool=memcheck" python gyp_libyuv
ninja -C out/Debug
valgrind out/Debug/libyuv_unittest
</pre><p>For more information, see <a href="http://www.chromium.org/developers/how-tos/using-valgrind">http://www.chromium.org/developers/how-tos/using-valgrind</a></p>
<h3>Running Thread Sanitizer (TSan)</h3>
<pre class="fragment">GYP_DEFINES="clang=0 target_arch=x64 build_for_tool=tsan" python gyp_libyuv
ninja -C out/Debug
valgrind out/Debug/libyuv_unittest
</pre><p>For more info, see <a href="http://www.chromium.org/developers/how-tos/using-valgrind/threadsanitizer">http://www.chromium.org/developers/how-tos/using-valgrind/threadsanitizer</a></p>
<h3>Running Address Sanitizer (ASan)</h3>
<pre class="fragment">GYP_DEFINES="clang=0 target_arch=x64 build_for_tool=asan" python gyp_libyuv
ninja -C out/Debug
valgrind out/Debug/libyuv_unittest
</pre><p>For more info, see <a href="http://dev.chromium.org/developers/testing/addresssanitizer">http://dev.chromium.org/developers/testing/addresssanitizer</a></p>
<h2>Benchmarking</h2>
<p><a class="el" href="protocol_the-p.html">The</a> unittests can be used to benchmark.</p>
<h3>Windows</h3>
<pre class="fragment">set LIBYUV_WIDTH=1280
set LIBYUV_HEIGHT=720
set LIBYUV_REPEAT=999
set LIBYUV_FLAGS=-1
out\Release\libyuv_unittest.exe --gtest_filter=*I420ToARGB_Opt
</pre><h3>Linux and Mac</h3>
<pre class="fragment">LIBYUV_WIDTH=1280 LIBYUV_HEIGHT=720 LIBYUV_REPEAT=1000 out/Release/libyuv_unittest --gtest_filter=*I420ToARGB_Opt

libyuvTest.I420ToARGB_Opt (547 ms)
</pre><p>Indicates 0.547 ms/frame for 1280 x 720.</p>
<h2>Making a change</h2>
<pre class="fragment">gclient sync
git checkout -b mycl -t origin/master
git pull
&lt;edit files&gt;
git add -u
git commit -m "my change"
git cl lint
git cl try
git cl upload -r a-reviewer@chomium.org -s
&lt;once approved..&gt;
git cl land</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
