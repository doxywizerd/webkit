<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Building BoringSSL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building BoringSSL </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Build Prerequisites</h2>
<ul>
<li><a href="https://cmake.org/download/">CMake</a> 2.8.8 or later is required.</li>
<li>Perl 5.6.1 or later is required. On Windows, <a href="http://www.activestate.com/activeperl/">Active State Perl</a> has been reported to work, as has MSYS Perl. <a href="http://strawberryperl.com/">Strawberry Perl</a> also works but it adds GCC to <code>PATH</code>, which can confuse some build tools when identifying the compiler (removing <code><a class="el" href="class_c.html">C</a>:\Strawberry\c\bin</code> from <code>PATH</code> should resolve any problems). If Perl is not found by CMake, it may be configured explicitly by setting <code>PERL_EXECUTABLE</code>.</li>
<li>On Windows you currently must use <a href="https://ninja-build.org/">Ninja</a> to build; on other platforms, it is not required, but recommended, because it makes builds faster.</li>
<li>If you need to build Ninja from source, then a recent version of <a href="https://www.python.org/downloads/">Python</a> is required (Python 2.7.5 works).</li>
<li>On Windows only, <a href="http://yasm.tortall.net/">Yasm</a> is required. If not found by CMake, it may be configured explicitly by setting <code>CMAKE_ASM_NASM_COMPILER</code>.</li>
<li><a class="el" href="struct_a.html">A</a> <a class="el" href="class_c.html">C</a> compiler is required. On Windows, MSVC 14 (Visual Studio 2015) or later with Platform SDK 8.1 or later are supported. Recent versions of GCC (4.8+) and Clang should work on non-Windows platforms, and maybe on Windows too. To build the tests, you also need a C++ compiler with C++11 support.</li>
<li><a href="https://golang.org/dl/">Go</a> is required. If not found by CMake, the go executable may be configured explicitly by setting <code>GO_EXECUTABLE</code>.</li>
<li>To build the x86 and x86_64 assembly, your assembler must support AVX2 instructions. If using GNU binutils, you must have 2.22 or later.</li>
</ul>
<h2>Building</h2>
<p>Using Ninja (note the 'N' is capitalized in the cmake invocation): </p><pre class="fragment">mkdir build
cd build
cmake -GNinja ..
ninja
</pre><p>Using Make (does not work on Windows): </p><pre class="fragment">mkdir build
cd build
cmake ..
make
</pre><p>You usually don't need to run <code>cmake</code> again after changing <code>CMakeLists.txt</code> files because the build scripts will detect changes to them and rebuild themselves automatically.</p>
<p>Note that the default build flags in the top-level <code>CMakeLists.txt</code> are for debuggingâ€”optimisation isn't enabled. Pass <code>-DCMAKE_BUILD_TYPE=Release</code> to <code>cmake</code> to configure a release build.</p>
<p>If you want to cross-compile then there is an example toolchain file for 32-bit Intel in <code>util/</code>. Wipe out the build directory, recreate it and run <code>cmake</code> like this: </p><pre class="fragment">cmake -DCMAKE_TOOLCHAIN_FILE=../util/32-bit-toolchain.cmake -GNinja ..
</pre><p>If you want to build as a shared library, pass <code>-DBUILD_SHARED_LIBS=1</code>. On Windows, where functions need to be tagged with <code>dllimport</code> when coming from a shared library, define <code>BORINGSSL_SHARED_LIBRARY</code> in any code which <code><a class="el" href="_fetch_request_8idl.html#a5ebd3c4b429e6d09e632bcedbc5f931ca96ddd0ddd9a94a707cb6f094877fda0d">include</a></code>s the BoringSSL headers.</p>
<p>In order to serve environments where code-size is important as well as those where performance is the overriding concern, <code>OPENSSL_SMALL</code> can be defined to remove some code that is especially large.</p>
<p>See <a href="https://cmake.org/cmake/help/v3.4/manual/cmake-variables.7.html">CMake's documentation</a> for other variables which may be used to configure the build.</p>
<h3>Building for Android</h3>
<p>It's possible to build BoringSSL with the Android NDK using CMake. This has been tested with version 10d of the NDK.</p>
<p>Unpack the Android NDK somewhere and export <code>ANDROID_NDK</code> to point to the directory. Then make a build directory as above and run CMake like this: </p><pre class="fragment">cmake -DANDROID_ABI=armeabi-v7a \
      -DCMAKE_TOOLCHAIN_FILE=../third_party/android-cmake/android.toolchain.cmake \
      -DANDROID_NATIVE_API_LEVEL=16 \
      -GNinja ..
</pre><p>Once you've run that, Ninja should produce Android-compatible binaries. You can replace <code>armeabi-v7a</code> in the above with <code>arm64-v8a</code> and use <a class="el" href="namespace_a_p_i.html">API</a> level 21 or higher to build aarch64 binaries.</p>
<p>For other options, see ./third_party/android-cmake/README.md "android-cmake's documentation".</p>
<h2>Known Limitations on Windows</h2>
<ul>
<li><p class="startli">Versions of CMake since 3.0.2 have a bug in its Ninja generator that causes yasm to output warnings </p><pre class="fragment">yasm: warning: can open only one input file, only the last file will be processed
</pre><p class="startli">These warnings can be safely ignored. <a class="el" href="protocol_the-p.html">The</a> cmake bug is <a href="http://www.cmake.org/Bug/view.php?id=15253">http://www.cmake.org/Bug/view.php?id=15253</a>.</p>
</li>
<li>CMake can generate Visual Studio projects, but the generated project files don't have steps for assembling the assembly language source files, so they currently cannot be used to build BoringSSL.</li>
</ul>
<h2>Embedded ARM</h2>
<p>ARM, unlike Intel, does not have an instruction that allows applications to discover the capabilities of the processor. Instead, the capability information has to be provided by the operating system somehow.</p>
<p>BoringSSL will try to use <code>getauxval</code> to discover the capabilities and, failing that, will probe for NEON support by executing a NEON instruction and handling any illegal-instruction signal. But some environments don't support that sort of thing and, for them, it's possible to configure the CPU capabilities at compile time.</p>
<p>If you define <code>OPENSSL_STATIC_ARMCAP</code> then you can define any of the following to enabling the corresponding ARM feature.</p>
<ul>
<li><code>OPENSSL_STATIC_ARMCAP_NEON</code> or <code>__ARM_NEON__</code> (note that the latter is set by compilers when NEON support is enabled).</li>
<li><code>OPENSSL_STATIC_ARMCAP_AES</code></li>
<li><code>OPENSSL_STATIC_ARMCAP_SHA1</code></li>
<li><code>OPENSSL_STATIC_ARMCAP_SHA256</code></li>
<li><code>OPENSSL_STATIC_ARMCAP_PMULL</code></li>
</ul>
<p>Note that if a feature is enabled in this way, but not actually supported at run-time, BoringSSL will likely crash.</p>
<h2>Assembling ARMv8 with Clang</h2>
<p>In order to support the ARMv8 crypto instructions, Clang requires that the architecture be <code>armv8-a+crypto</code>. However, setting that as a general build flag would allow the compiler to assume that crypto instructions are <em>always</em> supported, even without testing for them.</p>
<p>It's possible to set the architecture in an assembly file using the <code>.arch</code> directive, but only very recent versions of Clang support this. If <code>BORINGSSL_CLANG_SUPPORTS_DOT_ARCH</code> is defined then <code>.arch</code> directives will be used with Clang, otherwise you may need to craft acceptable assembler flags.</p>
<h1>Running tests</h1>
<p>There are two sets of tests: the C/C++ tests and the blackbox tests. For former are built by Ninja and can be run from the top-level directory with <code>go run util/all_tests.go</code>. <a class="el" href="protocol_the-p.html">The</a> latter have to be run separately by running <code>go test</code> from within <code>ssl/test/runner</code>.</p>
<p>Both sets of tests may also be run with <code>ninja -C build <a class="el" href="namespacerun__tests.html">run_tests</a></code>, but CMake 3.2 or later is required to avoid Ninja's output buffering. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
