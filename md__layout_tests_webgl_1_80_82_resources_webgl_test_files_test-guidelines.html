<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Contributing WebGL conformance tests Guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Contributing WebGL conformance tests Guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Thank you for contributing to the WebGL conformance tests. Please try to follow these guidelines when submitting a test.</p>
<ul>
<li>If you're new to git <a href="http://www.khronos.org/webgl/wiki/Using_Github_To_Contribute" title="Using Github to Contribute">here's a terse set of instructions</a>.</li>
<li>All changes and/or new tests should go in the sdk/tests/conformance folder</li>
</ul>
<p><a class="el" href="protocol_the-p.html">The</a> tests under conformance-suites are snapshots and are only to be updated by the WebGL Working Group when "official" snapshots are taken.</p>
<ul>
<li>Please use the Khronos Group License (MIT)</li>
</ul>
<p>These lines appears at the top of every html and js file under sdk/tests/conformance</p>
<ul>
<li><p class="startli">Please use code similar to the code in existing tests</p>
<p class="startli">Ideally, copy an existing test and modify it for your new test. Try not to duplicate code that already exists where appropriate. In particular</p><ul>
<li><p class="startli">use the functions in WebGLTestUtils rather than duplicating functionality.</p>
<p class="startli">In particular, as much as possible, keep the WebGL code in your test specific to the issue being tested and try to use the helper functions to handle common setup.</p>
<p class="startli">Examples:</p><ul>
<li>to create a WebGL context call <code>WebGLTestUtils.create3DContext</code>. Passed nothing it will create an offscreen canvas. Passed a canvas element it will create a context on that element. Passed a string it will look up the canvas element with the matching id and create a context from that element.</li>
<li>use <code>WebGLTestUtils.checkCanvas</code> or <code>WebGLTestUtils.checkCanvasRect</code> rather than checking rendering results by hand.</li>
<li>use the various quad and draw functions<ul>
<li><code>WebGLTestUtils.setupUnitQuad</code> and <code>WebGLTestUtils.clearAndDrawUnitQuad</code> for simple drawing.</li>
<li><code>WebGLTestUtils.setupColorQuad</code>, <code>WebGLTestUtils.drawFloatColorQuad</code>, and <code>WebGLTestUilts.drawUByteColorQuad</code> for drawing in a particular color.</li>
<li><code>WebGLTestUtils.setupIndexedQuad</code> and <code>WebGLTestUtils.clearAndDrawIndexedQuad</code> if you need a higher subdivision of vertices and/or vertex colors.</li>
<li>use <code>WebgLTestUtils.setupTexturedQuad</code> if you need a unit quad with texture coords. By default the positions will be at location 0 and the texture coords at location 1.</li>
</ul>
</li>
<li><p class="startli">If you need a custom shader use <code>WebGLTestUtils.setupProgram</code>. Note that it takes the following arguments. <code>gl</code>, <code>shaders</code>, <code>opt_attribs</code>, <code>opt_locations</code> where:</p>
<p class="startli"><code>gl</code> is the WebGL context.</p>
<p class="startli"><code>shaders</code> are an array of either script element ids, shader source, or <a class="el" href="interface_web_g_l_shader.html">WebGLShader</a> objects. <a class="el" href="protocol_the-p.html">The</a> first element in the array is the vertex shader, the second the fragment shader.</p>
<p class="startli"><code>opt_attribs</code> is an optional array of attribute names. If provided the named attributes will have their locations bound to their index in this array.</p>
<p class="startli"><code>opt_locations</code> is an optional array of attribute locations. If provided each attribute name in <code>opt_attribs</code> is bound to the corresponding location in <code>opt_locations</code>.</p>
</li>
<li>If you need to wait for a composite call <code>WebGLTestUtils.waitForComposite</code>. As compositing is a browser specific thing this provides a central place to update all tests that rely on compositing to function.</li>
</ul>
</li>
<li><p class="startli">Code/Tag Order</p>
<p class="startli">Most tests run inline. They don't use window.onload or the load event. This works by placing the script tag inside the body, <em>after</em> the canvas and required divs. </p><pre class="fragment">&lt;canvas id="example"&gt;&lt;/canvas&gt;
&lt;div id="description"&gt;&lt;/div&gt;
&lt;div id="console"&gt;&lt;/div&gt;
&lt;script&gt;
var wtu = WebGLDebugUtils;
var gl = wtu.create3DContext("example");
...
</pre></li>
<li>Ending Tests<ul>
<li>Tests that are short and run synchronously end with <pre class="fragment">&lt;script src="../../resources/js-test-post.js"&gt;&lt;/script&gt;
</pre></li>
<li><p class="startli">Tests that take a long time use setTimeout so as not to freeze the browser.</p>
<p class="startli">Many browsers will terminate JavaScript that takes more than a few seconds to execute without returning control to the browser. <a class="el" href="protocol_the-p.html">The</a> workaround is code like this </p><pre class="fragment">var numTests = 10;
var currenTest = 0;
function runNextTest() {
  if (currentTest == numTests) {
    finishTest();  // Tells the harness you're done.
    return;
  }
  // Run your test.
  ...
  ++currentTest;
  setTimeout(runNextTest, 100);
}
runNextTest();
</pre><p class="startli">Remember the tests need to run without timing out even and slow mobile devices. <a class="el" href="protocol_the-p.html">The</a> harness resets the timeout timer every time a test reports success or failure so as long as some part of your test calls <code>testPassed</code> or <code>testFailed</code> or one of the many wrappers (<code>shouldXXX</code>, <code>glErrorShouldBe</code>, <code>WebGLTestUtils.checkCanvasXXX</code>, etc..) every so often the harness will not timeout your test.</p>
</li>
<li><a class="el" href="protocol_the-p.html">The</a> test harness requires the global variable <code>successfullyParse</code> to be set to true. This usually appears at the end of a file. <pre class="fragment">var successfullyParsed = true;
</pre></li>
</ul>
</li>
<li>Do not use browser specific code.<ul>
<li>Do not check the browser version. Use feature detection.</li>
<li>If you do need feature detection consider putting it into WebGLTestUtils so that other tests can go through the same abstraction and the workaround is isolated to one place.</li>
<li>Vendors may place test harness specific code in the testing infrastructure. <pre class="fragment">resources/js-test-pre.js
conformance/more/unit.js
</pre></li>
</ul>
</li>
<li>Indent with spaces not tabs. (not everyone uses your tab settings).</li>
<li>All HTML files must have a <code>&lt;!DOCTYPE html&gt;</code></li>
<li>All HTML files must have a <code>&lt;meta charset="utf-8"&gt;</code></li>
<li>All JavaScript must start with "use strict";</li>
</ul>
</li>
<li><p class="startli">If adding a new test edit the appropriate 00_test_list.txt file</p>
<p class="startli">Each folder has a 00_test_list.txt file that lists the test in that folder. Each new test should be prefixed with the option <code>--min-version &lt;version&gt;</code> where version is 1 more than the newest official version. At the time of this writing all new tests should be prefixed with <code>--min-version 1.0.2</code> </p>
</li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
