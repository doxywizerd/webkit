<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Incorporating BoringSSL into a project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Incorporating BoringSSL into a project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Note</b>: if your target project is not a <a class="el" href="namespace_google.html">Google</a> project then first read the /README.md "main README" about the purpose of BoringSSL.</p>
<h2>Bazel</h2>
<p>If you are using <a href="http://www.bazel.io">Bazel</a> then you can incorporate BoringSSL as an external repository by using a commit from the <code>master-with-bazel</code> branch. That branch is maintained by a bot from <code>master</code> and includes the needed generated files and a top-level BUILD file.</p>
<p>For example: </p><pre class="fragment">git_repository(
    name = "boringssl",
    commit = "_some commit_",
    remote = "https://boringssl.googlesource.com/boringssl",
)
</pre><p>You would still need to keep the referenced commit up to date if a specific commit is referred to.</p>
<h2>Directory layout</h2>
<p>Typically projects create a <code>third_party/boringssl</code> directory to put BoringSSL-specific files into. <a class="el" href="protocol_the-p.html">The</a> source code of BoringSSL itself goes into <code>third_party/boringssl/src</code>, either by copying or as a <a href="https://git-scm.com/docs/git-submodule">submodule</a>.</p>
<p>It's generally a mistake to put BoringSSL's source code into <code>third_party/boringssl</code> directly because pre-built files and custom build files need to go somewhere and merging these with the BoringSSL source code makes updating things more complex.</p>
<h2>Build support</h2>
<p>BoringSSL is designed to work with many different build systems. Currently, different projects use <a href="https://gyp.gsrc.io/">GYP</a>, https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/quick_start.md "GN", <a href="http://bazel.io/">Bazel</a> and <a href="https://www.gnu.org/software/make/">Make</a> to build BoringSSL, without too much pain.</p>
<p><a class="el" href="protocol_the-p.html">The</a> development build system is CMake and the CMake build knows how to automatically generate the intermediate files that BoringSSL needs. However, outside of the CMake environment, these intermediates are generated once and checked into the incorporating project's source repository. This avoids incorporating projects needing to support Perl and Go in their build systems.</p>
<p><a class="el" href="protocol_the-p.html">The</a> script <a href="/util/generate_build_files.py"><code>util/generate_build_files.py</code></a> expects to be run from the <code>third_party/boringssl</code> directory and to find the BoringSSL source code in <code>src/</code>. You should pass it a single argument: the name of the build system that you're using. If you don't use any of the supported build systems then you should augment <code><a class="el" href="generate__build__files_8py.html">generate_build_files.py</a></code> with support for it.</p>
<p><a class="el" href="protocol_the-p.html">The</a> script will pregenerate the intermediate files (see /BUILDING.md "BUILDING.md" for details about which tools will need to be installed) and output helper files for that build system. It doesn't generate a complete build script, just file and test lists, which change often. For example, see the <a href="https://code.google.com/p/chromium/codesearch#chromium/src/third_party/boringssl/BUILD.generated.gni">file</a> and <a href="https://code.google.com/p/chromium/codesearch#chromium/src/third_party/boringssl/BUILD.generated_tests.gni">test</a> lists generated for GN in Chromium.</p>
<p>Generally one checks in these generated files alongside the hand-written build files. Periodically an engineer updates the BoringSSL revision, regenerates these files and checks in the updated result. As an example, see how this is done <a href="https://code.google.com/p/chromium/codesearch#chromium/src/third_party/boringssl/">in Chromium</a>.</p>
<h2>Defines</h2>
<p>BoringSSL does not present a lot of configurability in order to reduce the number of configurations that need to be tested. But there are a couple of #defines that you may wish to set:</p>
<p><code>OPENSSL_NO_ASM</code> prevents the use of assembly code (although it's up to you to ensure that the build system doesn't link it in if you wish to reduce binary size). This will have a significant performance impact but can be useful if you wish to use tools like <a href="http://clang.llvm.org/docs/AddressSanitizer.html">AddressSanitizer</a> that interact poorly with assembly code.</p>
<p><code>OPENSSL_SMALL</code> removes some code that is especially large at some performance cost.</p>
<h2>Symbols</h2>
<p>You cannot link multiple versions of BoringSSL or OpenSSL into a single binary without dealing with symbol conflicts. If you are statically linking multiple versions together, there's not a lot that can be done because <a class="el" href="class_c.html">C</a> doesn't have a module system.</p>
<p>If you are using multiple versions in a single binary, in different shared objects, ensure you build BoringSSL with <code>-fvisibility=hidden</code> and do not export any of BoringSSL's symbols. This will prevent any collisions with other verisons that may be included in other shared objects. Note that this requires that all callers of BoringSSL APIs live in the same shared object as BoringSSL.</p>
<p>If you require that BoringSSL APIs be used across shared object boundaries, continue to build with <code>-fvisibility=hidden</code> but define <code>BORINGSSL_SHARED_LIBRARY</code> in both BoringSSL and consumers. BoringSSL's own source files (but <em>not</em> consumers' source files) must also build with <code>BORINGSSL_IMPLEMENTATION</code> defined. This will export BoringSSL's public symbols in the resulting shared object while hiding private symbols. However note that, as with a static link, this precludes dynamically linking with another version of BoringSSL or OpenSSL. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
