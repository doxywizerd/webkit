<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: Getting Started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>How to get and build the libyuv code.</p>
<h2>Pre-requisites</h2>
<p>You'll need to have depot tools installed: <a href="https://www.chromium.org/developers/how-tos/install-depot-tools">https://www.chromium.org/developers/how-tos/install-depot-tools</a> Refer to chromium instructions for each platform for other prerequisites.</p>
<h2>Getting the Code</h2>
<p>Create a working directory, enter it, and run: </p><pre class="fragment">gclient config https://chromium.googlesource.com/libyuv/libyuv
gclient sync
</pre><p>Then you'll get a .gclient file like: </p><pre class="fragment">solutions = [
  { "name"        : "libyuv",
    "url"         : "https://chromium.googlesource.com/libyuv/libyuv",
    "deps_file"   : "DEPS",
    "managed"     : True,
    "custom_deps" : {
    },
    "safesync_url": "",
  },
];
</pre><p>For iOS add `;target_os=['ios'];<code>to your OSX .gclient and run</code>GYP_DEFINES="OS=ios" gclient sync.`</p>
<p>Browse the Git reprository: <a href="https://chromium.googlesource.com/libyuv/libyuv/+/master">https://chromium.googlesource.com/libyuv/libyuv/+/master</a></p>
<h3>Android</h3>
<p>For Android add `;target_os=['android'];` to your Linux .gclient </p><pre class="fragment">solutions = [
  { "name"        : "libyuv",
    "url"         : "https://chromium.googlesource.com/libyuv/libyuv",
    "deps_file"   : "DEPS",
    "managed"     : True,
    "custom_deps" : {
    },
    "safesync_url": "",
  },
];
target_os = ["android", "unix"];
</pre><p>Then run: </p><pre class="fragment">export GYP_DEFINES="OS=android"
gclient sync
</pre><p>Caveat: Theres an error with <a class="el" href="namespace_google.html">Google</a> Play services updates. If you get the error "Your version of the Google Play services library is not up to date", run the following: </p><pre class="fragment">cd chromium/src
./build/android/play_services/update.py download
cd ../..
</pre><p>For Windows the gclient sync must be done from an Administrator command prompt.</p>
<p><a class="el" href="protocol_the-p.html">The</a> sync will generate native build files for your environment using gyp (Windows: Visual Studio, OSX: XCode, Linux: make). This generation can also be forced manually: <code>gclient runhooks</code></p>
<p>To get just the source (not buildable): </p><pre class="fragment">git clone https://chromium.googlesource.com/libyuv/libyuv
</pre><h2>Building the Library and Unittests</h2>
<h3>Windows</h3>
<pre class="fragment">call gn gen out/Release "--args=is_debug=false target_cpu=\"x86\""
call gn gen out/Debug "--args=is_debug=true target_cpu=\"x86\""
ninja -j7 -v -C out/Release
ninja -j7 -v -C out/Debug

call gn gen out/Release "--args=is_debug=false target_cpu=\"x64\""
call gn gen out/Debug "--args=is_debug=true target_cpu=\"x64\""
ninja -j7 -v -C out/Release
ninja -j7 -v -C out/Debug
</pre><h4>Building with clang-cl</h4>
<pre class="fragment">set GYP_DEFINES=clang=1 target_arch=ia32
call python tools\clang\scripts\update.py

call gn gen out/Release "--args=is_debug=false is_official_build=false is_clang=true target_cpu=\"x86\""
call gn gen out/Debug "--args=is_debug=true is_official_build=false is_clang=true target_cpu=\"x86\""
ninja -j7 -v -C out/Release
ninja -j7 -v -C out/Debug

call gn gen out/Release "--args=is_debug=false is_official_build=false is_clang=true target_cpu=\"x64\""
call gn gen out/Debug "--args=is_debug=true is_official_build=false is_clang=true target_cpu=\"x64\""
ninja -j7 -v -C out/Release
ninja -j7 -v -C out/Debug
</pre><h3>macOS and Linux</h3>
<pre class="fragment">gn gen out/Release "--args=is_debug=false"
gn gen out/Debug "--args=is_debug=true"
ninja -j7 -v -C out/Release
ninja -j7 -v -C out/Debug
</pre><h3>Building Offical with GN</h3>
<pre class="fragment">gn gen out/Official "--args=is_debug=false is_official_build=true is_chrome_branded=true"
ninja -C out/Official
</pre><h3>iOS</h3>
<p>This section needs an update to GN build documentation. <a href="http://www.chromium.org/developers/how-tos/build-instructions-ios">http://www.chromium.org/developers/how-tos/build-instructions-ios</a></p>
<p>Add to .gclient last line: `target_os=['ios'];`</p>
<p>armv7 </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=armv7 target_subarch=arm32" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>arm64 </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=arm64 target_subarch=arm64" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>both armv7 and arm64 (fat) </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=armv7 target_subarch=both" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_ios" ./gyp_libyuv
ninja -j7 -C out_ios/Debug-iphoneos libyuv_unittest
ninja -j7 -C out_ios/Release-iphoneos libyuv_unittest
</pre><p>simulator </p><pre class="fragment">GYP_DEFINES="OS=ios target_arch=ia32 target_subarch=arm32" GYP_CROSSCOMPILE=1 GYP_GENERATOR_FLAGS="output_dir=out_sim" ./gyp_libyuv
ninja -j7 -C out_sim/Debug-iphonesimulator libyuv_unittest
ninja -j7 -C out_sim/Release-iphonesimulator libyuv_unittest
</pre><h3>Android</h3>
<p><a href="https://code.google.com/p/chromium/wiki/AndroidBuildInstructions">https://code.google.com/p/chromium/wiki/AndroidBuildInstructions</a></p>
<p>Add to .gclient last line: `target_os=['android'];`</p>
<p>armv7 </p><pre class="fragment">gn gen out/Release "--args=is_debug=false target_os=\"android\" target_cpu=\"arm\""
gn gen out/Debug "--args=is_debug=true target_os=\"android\" target_cpu=\"arm\""
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest
</pre><p>arm64 </p><pre class="fragment">gn gen out/Release "--args=is_debug=false target_os=\"android\" target_cpu=\"arm64\""
gn gen out/Debug "--args=is_debug=true target_os=\"android\" target_cpu=\"arm64\""
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest
</pre><p>ia32 </p><pre class="fragment">gn gen out/Release "--args=is_debug=false target_os=\"android\" target_cpu=\"x86\""
gn gen out/Debug "--args=is_debug=true target_os=\"android\" target_cpu=\"x86\""
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest
</pre><p>mipsel </p><pre class="fragment">gn gen out/Release "--args=is_debug=false target_os=\"android\" target_cpu=\"mipsel\" mips_arch_variant=\"r6\" mips_use_msa=true is_component_build=true is_clang=false"
gn gen out/Debug "--args=is_debug=true target_os=\"android\" target_cpu=\"mipsel\" mips_arch_variant=\"r6\" mips_use_msa=true is_component_build=true is_clang=false"
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest

gn gen out/Release "--args=is_debug=false target_os=\"android\" target_cpu=\"mips64el\" mips_arch_variant=\"r6\" mips_use_msa=true is_component_build=true is_clang=false"
gn gen out/Debug "--args=is_debug=true target_os=\"android\" target_cpu=\"mips64el\" mips_arch_variant=\"r6\" mips_use_msa=true is_component_build=true is_clang=false"
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest
</pre><p>arm disassembly: </p><pre class="fragment">third_party/android_tools/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/linux-x86_64/bin/aarch64-linux-android-objdump -d ./out/Release/obj/libyuv/row_common.o &gt;row_common.txt

third_party/android_tools/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/linux-x86_64/bin/aarch64-linux-android-objdump -d ./out/Release/obj/libyuv_neon/row_neon.o &gt;row_neon.txt

third_party/android_tools/ndk/toolchains/aarch64-linux-android-4.9/prebuilt/linux-x86_64/bin/aarch64-linux-android-objdump -d ./out/Release/obj/libyuv_neon/row_neon64.o &gt;row_neon64.txt
</pre><p>Running tests: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=*
</pre><p>Running test as benchmark: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=* -a "--libyuv_width=1280 --libyuv_height=720 --libyuv_repeat=999 --libyuv_flags=-1  --libyuv_cpu_info=-1"
</pre><p>Running test with <a class="el" href="class_c.html">C</a> code: </p><pre class="fragment">util/android/test_runner.py gtest -s libyuv_unittest -t 7200 --verbose --release --gtest_filter=* -a "--libyuv_width=1280 --libyuv_height=720 --libyuv_repeat=999 --libyuv_flags=1 --libyuv_cpu_info=1"
</pre><h3>Build targets</h3>
<pre class="fragment">ninja -C out/Debug libyuv
ninja -C out/Debug libyuv_unittest
ninja -C out/Debug compare
ninja -C out/Debug convert
ninja -C out/Debug psnr
ninja -C out/Debug cpuid
</pre><h3>ARM Linux</h3>
<pre class="fragment">gn gen out/Release "--args=is_debug=false target_cpu=\"arm64\""
gn gen out/Debug "--args=is_debug=true target_cpu=\"arm64\""
ninja -j7 -v -C out/Debug libyuv_unittest
ninja -j7 -v -C out/Release libyuv_unittest
</pre><h2>Building the Library with make</h2>
<h3>Linux</h3>
<pre class="fragment">make -j7 V=1 -f linux.mk
make -j7 V=1 -f linux.mk clean
make -j7 V=1 -f linux.mk CXX=clang++
</pre><h2>Building the Library with cmake</h2>
<p>Install cmake: <a href="http://www.cmake.org/">http://www.cmake.org/</a></p>
<p>Default debug build: </p><pre class="fragment">mkdir out
cd out
cmake ..
cmake --build .
</pre><p>Release build/install </p><pre class="fragment">mkdir out
cd out
cmake -DCMAKE_INSTALL_PREFIX="/usr/lib" -DCMAKE_BUILD_TYPE="Release" ..
cmake --build . --config Release
sudo cmake --build . --target install --config Release
</pre><h2>Running Unittests</h2>
<h3>Windows</h3>
<pre class="fragment">out\Release\libyuv_unittest.exe --gtest_catch_exceptions=0 --gtest_filter="*"
</pre><h3>OSX</h3>
<pre class="fragment">out/Release/libyuv_unittest --gtest_filter="*"
</pre><h3>Linux</h3>
<pre class="fragment">out/Release/libyuv_unittest --gtest_filter="*"
</pre><p>Replace &ndash;gtest_filter="*" with specific unittest to run. May include wildcards. e.g. </p><pre class="fragment">out/Release/libyuv_unittest --gtest_filter=*I420ToARGB_Opt
</pre><h2>CPU Emulator tools</h2>
<h3>Intel SDE (Software Development Emulator)</h3>
<p>Pre-requisite: Install IntelSDE: <a href="http://software.intel.com/en-us/articles/intel-software-development-emulator">http://software.intel.com/en-us/articles/intel-software-development-emulator</a></p>
<p>Then run: </p><pre class="fragment">c:\intelsde\sde -hsw -- out\Release\libyuv_unittest.exe --gtest_filter=*

~/intelsde/sde -skx -- out/Release/libyuv_unittest --gtest_filter=**I420ToARGB_Opt
</pre><h2>Sanitizers</h2>
<pre class="fragment">gn gen out/Debug "--args=is_debug=true is_asan=true"
ninja -j7 -v -C out/Debug

Sanitizers available: tsan, msan, asan, ubsan, lsan
</pre><h3>Running Dr Memory memcheck for Windows</h3>
<p>Pre-requisite: Install Dr Memory for Windows and add it to your path: <a href="http://www.drmemory.org/docs/page_install_windows.html">http://www.drmemory.org/docs/page_install_windows.html</a> </p><pre class="fragment">drmemory out\Debug\libyuv_unittest.exe --gtest_catch_exceptions=0 --gtest_filter=*</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
