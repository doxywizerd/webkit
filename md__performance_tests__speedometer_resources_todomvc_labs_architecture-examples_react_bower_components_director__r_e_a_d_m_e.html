<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="https://github.com/flatiron/director/raw/master/img/director.png"/>
</div>
<h1>Synopsis</h1>
<p>Director is a router. Routing is the process of determining what code to run when a URL is requested.</p>
<h1>Motivation</h1>
<p><a class="el" href="struct_a.html">A</a> routing library that works in both the browser and node.js environments with as few differences as possible. Simplifies the development of Single Page Apps and Node.js applications. Dependency free (doesn't require jQuery or Express, etc).</p>
<h1>Status</h1>
<p><a href="http://travis-ci.org/flatiron/director"></a></p>
<h1>Features</h1>
<ul>
<li><a href="#client-side">Client-Side Routing</a></li>
<li><a href="#http-routing">Server-Side HTTP Routing</a></li>
<li><a href="#cli-routing">Server-Side CLI Routing</a></li>
</ul>
<h1>Usage</h1>
<ul>
<li><a href="#api-documentation">API Documentation</a></li>
<li><a href="#faq">Frequently Asked Questions</a></li>
</ul>
<p><a class="anchor" id="client-side"></a> </p><h2>Client-side Routing</h2>
<p>It simply watches the hash of the URL to determine what to do, for example:</p>
<div class="fragment"><div class="line">http://foo.com/#/bar</div></div><!-- fragment --><p>Client-side routing (aka hash-routing) allows you to specify some information about the state of the application using the URL. So that when the user visits a specific URL, the application can be transformed accordingly.</p>
<div class="image">
<img src="https://github.com/flatiron/director/raw/master/img/hashRoute.png"/>
</div>
<p>Here is a simple example:</p>
<div class="fragment"><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">    &lt;title&gt;A Gentle Introduction&lt;/title&gt;</div><div class="line">    &lt;script src=&quot;https://raw.github.com/flatiron/director/master/build/director.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line"></div><div class="line">      var author = function () { console.log(&quot;author&quot;); },</div><div class="line">          books = function () { console.log(&quot;books&quot;); },</div><div class="line">          viewBook = function(bookId) { console.log(&quot;viewBook: bookId is populated: &quot; + bookId); };</div><div class="line"></div><div class="line">      var routes = {</div><div class="line">        &#39;/author&#39;: author,</div><div class="line">        &#39;/books&#39;: [books, function() { console.log(&quot;An inline route handler.&quot;); }],</div><div class="line">        &#39;/books/view/:bookId&#39;: viewBook</div><div class="line">      };</div><div class="line"></div><div class="line">      var router = Router(routes);</div><div class="line">      router.init();</div><div class="line"></div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">      &lt;li&gt;&lt;a href=&quot;#/author&quot;&gt;#/author&lt;/a&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;a href=&quot;#/books&quot;&gt;#/books&lt;/a&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;a href=&quot;#/books/view/1&quot;&gt;#/books/view/1&lt;/a&gt;&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></div><!-- fragment --><p>Director works great with your favorite DOM library, such as jQuery.</p>
<div class="fragment"><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">    &lt;title&gt;A Gentle Introduction 2&lt;/title&gt;</div><div class="line">    &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;https://raw.github.com/flatiron/director/master/build/director.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">    $(&#39;document&#39;).ready(function(){</div><div class="line">      //</div><div class="line">      // create some functions to be executed when</div><div class="line">      // the correct route is issued by the user.</div><div class="line">      //</div><div class="line">      var showAuthorInfo = function () { console.log(&quot;showAuthorInfo&quot;); },</div><div class="line">          listBooks = function () { console.log(&quot;listBooks&quot;); },</div><div class="line">          allroutes = function() {</div><div class="line">            var route = window.location.hash.slice(2),</div><div class="line">                sections = $(&#39;section&#39;),</div><div class="line">                section;</div><div class="line">            if ((section = sections.filter(&#39;[data-route=&#39; + route + &#39;]&#39;)).length) {</div><div class="line">              sections.hide(250);</div><div class="line">              section.show(250);</div><div class="line">            }</div><div class="line">          };</div><div class="line"></div><div class="line">      //</div><div class="line">      // define the routing table.</div><div class="line">      //</div><div class="line">      var routes = {</div><div class="line">        &#39;/author&#39;: showAuthorInfo,</div><div class="line">        &#39;/books&#39;: listBooks</div><div class="line">      };</div><div class="line"></div><div class="line">      //</div><div class="line">      // instantiate the router.</div><div class="line">      //</div><div class="line">      var router = Router(routes);</div><div class="line"></div><div class="line">      //</div><div class="line">      // a global configuration setting.</div><div class="line">      //</div><div class="line">      router.configure({</div><div class="line">        on: allroutes</div><div class="line">      });</div><div class="line">      router.init();</div><div class="line">    });</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;section data-route=&quot;author&quot;&gt;Author Name&lt;/section&gt;</div><div class="line">    &lt;section data-route=&quot;books&quot;&gt;Book1, Book2, Book3&lt;/section&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">      &lt;li&gt;&lt;a href=&quot;#/author&quot;&gt;#/author&lt;/a&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;a href=&quot;#/books&quot;&gt;#/books&lt;/a&gt;&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></div><!-- fragment --><p>You can find a browser-specific build of <code>director</code> <a href="https://github.com/flatiron/director/blob/master/build/director.min.js">here</a> which has all of the server code stripped away.</p>
<p><a class="anchor" id="http-routing"></a> </p><h2>Server-Side HTTP Routing</h2>
<p>Director handles routing for HTTP requests similar to <code>journey</code> or <code>express</code>:</p>
<div class="fragment"><div class="line">//</div><div class="line">// require the native http module, as well as director.</div><div class="line">//</div><div class="line">var http = require(&#39;http&#39;),</div><div class="line">    director = require(&#39;director&#39;);</div><div class="line"></div><div class="line">//</div><div class="line">// create some logic to be routed to.</div><div class="line">//</div><div class="line">function helloWorld() {</div><div class="line">  this.res.writeHead(200, { &#39;Content-Type&#39;: &#39;text/plain&#39; })</div><div class="line">  this.res.end(&#39;hello world&#39;);</div><div class="line">}</div><div class="line"></div><div class="line">//</div><div class="line">// define a routing table.</div><div class="line">//</div><div class="line">var router = new director.http.Router({</div><div class="line">  &#39;/hello&#39;: {</div><div class="line">    get: helloWorld</div><div class="line">  }</div><div class="line">});</div><div class="line"></div><div class="line">//</div><div class="line">// setup a server and when there is a request, dispatch the</div><div class="line">// route that was requested in the request object.</div><div class="line">//</div><div class="line">var server = http.createServer(function (req, res) {</div><div class="line">  router.dispatch(req, res, function (err) {</div><div class="line">    if (err) {</div><div class="line">      res.writeHead(404);</div><div class="line">      res.end();</div><div class="line">    }</div><div class="line">  });</div><div class="line">});</div><div class="line"></div><div class="line">//</div><div class="line">// You can also do ad-hoc routing, similar to `journey` or `express`.</div><div class="line">// This can be done with a string or a regexp.</div><div class="line">//</div><div class="line">router.get(&#39;/bonjour&#39;, helloWorld);</div><div class="line">router.get(/hola/, helloWorld);</div><div class="line"></div><div class="line">//</div><div class="line">// set the server to listen on port `8080`.</div><div class="line">//</div><div class="line">server.listen(8080);</div></div><!-- fragment --><h3>See Also:</h3>
<ul>
<li>Auto-generated Node.js <a class="el" href="namespace_a_p_i.html">API</a> Clients for routers using <a href="http://github.com/flatiron/director-reflector">Director-Reflector</a></li>
<li>RESTful Resource routing using <a href="http://github.com/flatiron/restful">restful</a></li>
<li>HTML / Plain <a class="el" href="interface_text.html">Text</a> views of routers using <a href="http://github.com/flatiron/director-explorer">Director-Explorer</a></li>
</ul>
<p><a class="anchor" id="cli-routing"></a> </p><h2>CLI Routing</h2>
<p>Director supports Command Line Interface routing. Routes for cli options are based on command line input (i.e. <code>process.argv</code>) instead of a URL.</p>
<div class="fragment"><div class="line">var director = require(&#39;director&#39;);</div><div class="line"></div><div class="line">var router = new director.cli.Router();</div><div class="line"></div><div class="line">router.on(&#39;create&#39;, function () {</div><div class="line">  console.log(&#39;create something&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">router.on(/destroy/, function () {</div><div class="line">  console.log(&#39;destroy something&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">// You will need to dispatch the cli arguments yourself</div><div class="line">router.dispatch(&#39;on&#39;, process.argv.slice(2).join(&#39; &#39;));</div></div><!-- fragment --><p>Using the cli router, you can dispatch commands by passing them as a string. For example, if this example is in a file called <code>foo.js</code>:</p>
<div class="fragment"><div class="line">$ node foo.js create</div><div class="line">create something</div><div class="line">$ node foo.js destroy</div><div class="line">destroy something</div></div><!-- fragment --><p><a class="anchor" id="api-documentation"></a> </p><h1><a class="el" href="namespace_a_p_i.html">API</a> Documentation</h1>
<ul>
<li><a href="#constructor">Constructor</a></li>
<li><a href="#routing-table">Routing Table</a></li>
<li><a href="#adhoc-routing">Adhoc Routing</a></li>
<li><a href="#scoped-routing">Scoped Routing</a></li>
<li><a href="#routing-events">Routing Events</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#url-matching">URL Matching</a></li>
<li><a href="#url-params">URL Params</a></li>
<li><a href="#route-recursion">Route Recursion</a></li>
<li><a href="#async-routing">Async Routing</a></li>
<li><a href="#resources">Resources</a></li>
<li><a href="#history-api">History API</a></li>
<li><a href="#instance-methods">Instance Methods</a></li>
<li><a href="#attach-to-this">Attach Properties to <code>this</code></a></li>
<li><a href="#http-streaming-body-parsing">HTTP Streaming and Body Parsing</a></li>
</ul>
<p><a class="anchor" id="constructor"></a> </p><h2>Constructor</h2>
<div class="fragment"><div class="line">var router = Router(routes);</div></div><!-- fragment --><p><a class="anchor" id="routing-table"></a> </p><h2>Routing Table</h2>
<p>An object literal that contains nested route definitions. <a class="el" href="struct_a.html">A</a> potentially nested set of key/value pairs. <a class="el" href="protocol_the-p.html">The</a> keys in the object literal represent each potential part of the URL. <a class="el" href="protocol_the-p.html">The</a> values in the object literal contain references to the functions that should be associated with them. <em>bark</em> and <em>meow</em> are two functions that you have defined in your code.</p>
<div class="fragment"><div class="line">//</div><div class="line">// Assign routes to an object literal.</div><div class="line">//</div><div class="line">var routes = {</div><div class="line">  //</div><div class="line">  // a route which assigns the function `bark`.</div><div class="line">  //</div><div class="line">  &#39;/dog&#39;: bark,</div><div class="line">  //</div><div class="line">  // a route which assigns the functions `meow` and `scratch`.</div><div class="line">  //</div><div class="line">  &#39;/cat&#39;: [meow, scratch]</div><div class="line">};</div><div class="line"></div><div class="line">//</div><div class="line">// Instantiate the router.</div><div class="line">//</div><div class="line">var router = Router(routes);</div></div><!-- fragment --><p><a class="anchor" id="adhoc-routing"></a> </p><h2>Adhoc Routing</h2>
<p>When developing large client-side or server-side applications it is not always possible to define routes in one location. Usually individual decoupled components register their own routes with the application router. We refer to this as <em>Adhoc Routing.</em> Lets take a look at the <a class="el" href="namespace_a_p_i.html">API</a> <code>director</code> exposes for adhoc routing:</p>
<p><b>Client-side Routing</b></p>
<p>``` js var router = new Router().<a class="el" href="namespace_web_core_1_1_h_t_m_l_names.html#acefdcbff51cfa53958cc3c01017a0385">init()</a>;</p>
<p>router.on('/some/resource', function () { // // Do something on <code>/#/some/resource</code> // }); ```</p>
<p><b>HTTP Routing</b></p>
<p>``` js var router = new director.http.Router();</p>
<p>router.get(/\/some\/resource/, function () { // // Do something on an GET to <code>/some/resource</code> // }); ```</p>
<p><a class="anchor" id="scoped-routing"></a> </p><h2>Scoped Routing</h2>
<p>In large web appliations, both <a href="#client-side">Client-side</a> and <a href="#http-routing">Server-side</a>, routes are often scoped within a few individual resources. Director exposes a simple way to do this for <a href="#adhoc-routing">Adhoc Routing</a> scenarios:</p>
<p>``` js var router = new director.http.Router();</p>
<p>// // Create routes inside the <code>/users</code> scope. // router.path(/\/users\/(+)/, function () { // // <a class="el" href="protocol_the-p.html">The</a> <code>this</code> context of the function passed to <code>.<a class="el" href="namespacegenerate.html#a32c241f006775b21e40d82f823b34dcf">path()</a></code> // is the Router itself. //</p>
<p>this.post(function (id) { // // Create the user with the specified <code>id</code>. // });</p>
<p>this.get(function (id) { // // Retreive the user with the specified <code>id</code>. // });</p>
<p>this.get(/\/friends/, function (id) { // // Get the friends for the user with the specified <code>id</code>. // }); }); </p><div class="fragment"><div class="line">&lt;a name=&quot;routing-events&quot;&gt;&lt;/a&gt;</div><div class="line">## Routing Events</div><div class="line"></div><div class="line">In `director`, a &quot;routing event&quot; is a named property in the [Routing Table](#routing-table) which can be assigned to a function or an Array of functions to be called when a route is matched in a call to `router.dispatch()`.</div><div class="line"></div><div class="line">* **on:** A function or Array of functions to execute when the route is matched.</div><div class="line">* **before:** A function or Array of functions to execute before calling the `on` method(s).</div><div class="line"></div><div class="line">**Client-side only**</div><div class="line"></div><div class="line">* **after:** A function or Array of functions to execute when leaving a particular route.</div><div class="line">* **once:** A function or Array of functions to execute only once for a particular route.</div><div class="line"></div><div class="line">&lt;a name=&quot;configuration&quot;&gt;&lt;/a&gt;</div><div class="line">## Configuration</div><div class="line"></div><div class="line">Given the flexible nature of `director` there are several options available for both the [Client-side](#client-side) and [Server-side](#http-routing). These options can be set using the `.configure()` method:</div><div class="line"></div><div class="line">``` js</div><div class="line">  var router = new director.Router(routes).configure(options);</div></div><!-- fragment --><p><a class="el" href="protocol_the-p.html">The</a> <code>options</code> are:</p>
<ul>
<li><b>recurse:</b> Controls <a href="#route-recursion">route recursion</a>. Use <code>forward</code>, <code>backward</code>, or <code>false</code>. Default is <code>false</code> Client-side, and <code>backward</code> Server-side.</li>
<li><b>strict:</b> If set to <code>false</code>, then trailing slashes (or other delimiters) are allowed in routes. Default is <code>true</code>.</li>
<li><b>async:</b> Controls <a href="#async-routing">async routing</a>. Use <code>true</code> or <code>false</code>. Default is <code>false</code>.</li>
<li><b>delimiter:</b> Character separator between route fragments. Default is <code>/</code>.</li>
<li><b>notfound:</b> <a class="el" href="struct_a.html">A</a> function to call if no route is found on a call to <code>router.dispatch()</code>.</li>
<li><b>on:</b> <a class="el" href="struct_a.html">A</a> function (or list of functions) to call on every call to <code>router.dispatch()</code> when a route is found.</li>
<li><b>before:</b> <a class="el" href="struct_a.html">A</a> function (or list of functions) to call before every call to <code>router.dispatch()</code> when a route is found.</li>
</ul>
<p><b>Client-side only</b></p>
<ul>
<li><b>resource:</b> An object to which string-based routes will be bound. This can be especially useful for late-binding to route functions (such as async client-side requires).</li>
<li><b>after:</b> <a class="el" href="struct_a.html">A</a> function (or list of functions) to call when a given route is no longer the active route.</li>
<li><b>html5history:</b> If set to <code>true</code> and client supports <code>pushState()</code>, then uses HTML5 <a class="el" href="interface_history.html">History</a> <a class="el" href="namespace_a_p_i.html">API</a> instead of hash fragments. See <a href="#history-api">History API</a> for more information.</li>
<li><b>run_handler_in_init:</b> If <code>html5history</code> is enabled, the route handler by default is executed upon <code><a class="el" href="namespace_web_core_1_1_h_t_m_l_names.html#acefdcbff51cfa53958cc3c01017a0385">Router.init()</a></code> since with real URIs the router can not know if it should call a route handler or not. Setting this to <code>false</code> disables the route handler initial execution.</li>
</ul>
<p><a class="anchor" id="url-matching"></a> </p><h2>URL Matching</h2>
<div class="fragment"><div class="line">var router = Router({</div><div class="line">  //</div><div class="line">  // given the route &#39;/dog/yella&#39;.</div><div class="line">  //</div><div class="line">  &#39;/dog&#39;: {</div><div class="line">    &#39;/:color&#39;: {</div><div class="line">      //</div><div class="line">      // this function will return the value &#39;yella&#39;.</div><div class="line">      //</div><div class="line">      on: function (color) { console.log(color) }</div><div class="line">    }</div><div class="line">  }</div><div class="line">});</div></div><!-- fragment --><p>Routes can sometimes become very complex, <code>simple/:tokens</code> don't always suffice. Director supports regular expressions inside the route names. <a class="el" href="protocol_the-p.html">The</a> values captured from the regular expressions are passed to your listener function.</p>
<div class="fragment"><div class="line">var router = Router({</div><div class="line">  //</div><div class="line">  // given the route &#39;/hello/world&#39;.</div><div class="line">  //</div><div class="line">  &#39;/hello&#39;: {</div><div class="line">    &#39;/(\\w+)&#39;: {</div><div class="line">      //</div><div class="line">      // this function will return the value &#39;world&#39;.</div><div class="line">      //</div><div class="line">      on: function (who) { console.log(who) }</div><div class="line">    }</div><div class="line">  }</div><div class="line">});</div></div><!-- fragment --><div class="fragment"><div class="line">var router = Router({</div><div class="line">  //</div><div class="line">  // given the route &#39;/hello/world/johny/appleseed&#39;.</div><div class="line">  //</div><div class="line">  &#39;/hello&#39;: {</div><div class="line">    &#39;/world/?([^\/]*)\/([^\/]*)/?&#39;: function (a, b) {</div><div class="line">      console.log(a, b);</div><div class="line">    }</div><div class="line">  }</div><div class="line">});</div></div><!-- fragment --><p><a class="anchor" id="url-params"></a> </p><h2>URL Parameters</h2>
<p>When you are using the same route fragments it is more descriptive to define these fragments by name and then use them in your <a href="#routing-table">Routing Table</a> or <a href="#adhoc-routing">Adhoc Routes</a>. Consider a simple example where a <code>userId</code> is used repeatedly.</p>
<div class="fragment"><div class="line">//</div><div class="line">// Create a router. This could also be director.cli.Router() or</div><div class="line">// director.http.Router().</div><div class="line">//</div><div class="line">var router = new director.Router();</div><div class="line"></div><div class="line">//</div><div class="line">// A route could be defined using the `userId` explicitly.</div><div class="line">//</div><div class="line">router.on(/([\w-_]+)/, function (userId) { });</div><div class="line"></div><div class="line">//</div><div class="line">// Define a shorthand for this fragment called `userId`.</div><div class="line">//</div><div class="line">router.param(&#39;userId&#39;, /([\\w\\-]+)/);</div><div class="line"></div><div class="line">//</div><div class="line">// Now multiple routes can be defined with the same</div><div class="line">// regular expression.</div><div class="line">//</div><div class="line">router.on(&#39;/anything/:userId&#39;, function (userId) { });</div><div class="line">router.on(&#39;/something-else/:userId&#39;, function (userId) { });</div></div><!-- fragment --><p><a class="anchor" id="route-recursion"></a> </p><h2>Route Recursion</h2>
<p>Can be assigned the value of <code>forward</code> or <code>backward</code>. <a class="el" href="protocol_the-p.html">The</a> recurse option will determine the order in which to fire the listeners that are associated with your routes. If this option is NOT specified or set to null, then only the listeners associated with an exact match will be fired.</p>
<h3>No recursion, with the URL /dog/angry</h3>
<div class="fragment"><div class="line">var routes = {</div><div class="line">  &#39;/dog&#39;: {</div><div class="line">    &#39;/angry&#39;: {</div><div class="line">      //</div><div class="line">      // Only this method will be fired.</div><div class="line">      //</div><div class="line">      on: growl</div><div class="line">    },</div><div class="line">    on: bark</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var router = Router(routes);</div></div><!-- fragment --><h3>Recursion set to <code>backward</code>, with the URL /dog/angry</h3>
<div class="fragment"><div class="line">var routes = {</div><div class="line">  &#39;/dog&#39;: {</div><div class="line">    &#39;/angry&#39;: {</div><div class="line">      //</div><div class="line">      // This method will be fired first.</div><div class="line">      //</div><div class="line">      on: growl</div><div class="line">    },</div><div class="line">    //</div><div class="line">    // This method will be fired second.</div><div class="line">    //</div><div class="line">    on: bark</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var router = Router(routes).configure({ recurse: &#39;backward&#39; });</div></div><!-- fragment --><h3>Recursion set to <code>forward</code>, with the URL /dog/angry</h3>
<div class="fragment"><div class="line">var routes = {</div><div class="line">  &#39;/dog&#39;: {</div><div class="line">    &#39;/angry&#39;: {</div><div class="line">      //</div><div class="line">      // This method will be fired second.</div><div class="line">      //</div><div class="line">      on: growl</div><div class="line">    },</div><div class="line">    //</div><div class="line">    // This method will be fired first.</div><div class="line">    //</div><div class="line">    on: bark</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var router = Router(routes).configure({ recurse: &#39;forward&#39; });</div></div><!-- fragment --><h3>Breaking out of recursion, with the URL /dog/angry</h3>
<div class="fragment"><div class="line">var routes = {</div><div class="line">  &#39;/dog&#39;: {</div><div class="line">    &#39;/angry&#39;: {</div><div class="line">      //</div><div class="line">      // This method will be fired first.</div><div class="line">      //</div><div class="line">      on: function() { return false; }</div><div class="line">    },</div><div class="line">    //</div><div class="line">    // This method will not be fired.</div><div class="line">    //</div><div class="line">    on: bark</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">//</div><div class="line">// This feature works in reverse with recursion set to true.</div><div class="line">//</div><div class="line">var router = Router(routes).configure({ recurse: &#39;backward&#39; });</div></div><!-- fragment --><p><a class="anchor" id="async-routing"></a> </p><h2>Async Routing</h2>
<p>Before diving into how Director exposes async routing, you should understand <a href="#route-recursion">Route Recursion</a>. At it's core route recursion is about evaluating a series of functions gathered when traversing the <a href="#routing-table">Routing Table</a>.</p>
<p>Normally this series of functions is evaluated synchronously. In async routing, these functions are evaluated asynchronously. Async routing can be extremely useful both on the client-side and the server-side:</p>
<ul>
<li><b>Client-side:</b> To ensure an animation or other async operations (such as HTTP requests for authentication) have completed before continuing evaluation of a route.</li>
<li><b>Server-side:</b> To ensure arbitrary async operations (such as performing authentication) have completed before continuing the evaluation of a route.</li>
</ul>
<p><a class="el" href="protocol_the-p.html">The</a> method signatures for route functions in synchronous and asynchronous evaluation are different: async route functions take an additional <code><a class="el" href="interfaces_8idl.html#a1235def1e0d0448d0d08e2b1a09a62b1a4519d7e9526e5ae11b7905e7976ea5ec">next()</a></code> callback.</p>
<h3>Synchronous route functions</h3>
<div class="fragment"><div class="line">var router = new director.Router();</div><div class="line"></div><div class="line">router.on(&#39;/:foo/:bar/:bazz&#39;, function (foo, bar, bazz) {</div><div class="line">  //</div><div class="line">  // Do something asynchronous with `foo`, `bar`, and `bazz`.</div><div class="line">  //</div><div class="line">});</div></div><!-- fragment --><h3>Asynchronous route functions</h3>
<div class="fragment"><div class="line">var router = new director.http.Router().configure({ async: true });</div><div class="line"></div><div class="line">router.on(&#39;/:foo/:bar/:bazz&#39;, function (foo, bar, bazz, next) {</div><div class="line">  //</div><div class="line">  // Go do something async, and determine that routing should stop</div><div class="line">  //</div><div class="line">  next(false);</div><div class="line">});</div></div><!-- fragment --><p><a class="anchor" id="resources"></a> </p><h2>Resources</h2>
<p><b>Available on the Client-side only.</b> An object literal containing functions. If a host object is specified, your route definitions can provide string literals that represent the function names inside the host object. <a class="el" href="struct_a.html">A</a> host object can provide the means for better encapsulation and design.</p>
<div class="fragment"><div class="line">var router = Router({</div><div class="line"></div><div class="line">  &#39;/hello&#39;: {</div><div class="line">    &#39;/usa&#39;: &#39;americas&#39;,</div><div class="line">    &#39;/china&#39;: &#39;asia&#39;</div><div class="line">  }</div><div class="line"></div><div class="line">}).configure({ resource: container }).init();</div><div class="line"></div><div class="line">var container = {</div><div class="line">  americas: function() { return true; },</div><div class="line">  china: function() { return true; }</div><div class="line">};</div></div><!-- fragment --><p><a class="anchor" id="history-api"></a> </p><h2><a class="el" href="interface_history.html">History</a> <a class="el" href="namespace_a_p_i.html">API</a></h2>
<p><b>Available on the Client-side only.</b> Director supports using HTML5 <a class="el" href="interface_history.html">History</a> <a class="el" href="namespace_a_p_i.html">API</a> instead of hash fragments for navigation. To use the <a class="el" href="namespace_a_p_i.html">API</a>, pass <code>{html5history: true}</code> to <code>configure()</code>. Use of the <a class="el" href="namespace_a_p_i.html">API</a> is enabled only if the client supports <code>pushState()</code>.</p>
<p>Using the <a class="el" href="namespace_a_p_i.html">API</a> gives you cleaner URIs but they come with a cost. Unlike with hash fragments your route URIs must exist. When the client enters a page, say <a href="http://foo.com/bar/baz,">http://foo.com/bar/baz,</a> the web server must respond with something meaningful. Usually this means that your web server checks the URI points to something that, in a sense, exists, and then serves the client the JavaScript application.</p>
<p>If you're after a single-page application you can not use plain old <code>&lt;a href="/bar/baz"&gt;</code> tags for navigation anymore. When such link is clicked, web browsers try to ask for the resource from server which is not of course desired for a single-page application. Instead you need to use e.g. click handlers and call the <code>setRoute()</code> method yourself.</p>
<p><a class="anchor" id="attach-to-this"></a> </p><h2>Attach Properties To <code>this</code></h2>
<p>Generally, the <code>this</code> object bound to route handlers, will contain the request in <code>this.req</code> and the response in <code>this.res</code>. One may attach additional properties to <code>this</code> with the <code>router.attach</code> method:</p>
<p>```js var director = require('director');</p>
<p>var router = new director.http.Router().configure(options);</p>
<p>// // Attach properties to <code>this</code> // router.attach(function () { this.data = [1,2,3]; });</p>
<p>// // Access properties attached to <code>this</code> in your routes! // router.get('/hello', function () { this.res.writeHead(200, { 'content-type': 'text/plain' });</p>
<p>// // Response will be <code>[1,2,3]</code>! // this.res.end(this.data); }); </p><div class="fragment"><div class="line">This API may be used to attach convenience methods to the `this` context of route handlers.</div><div class="line"></div><div class="line">&lt;a name=&quot;http-streaming-body-parsing&quot;&gt;</div><div class="line">## HTTP Streaming and Body Parsing</div><div class="line"></div><div class="line">When you are performing HTTP routing there are two common scenarios:</div><div class="line"></div><div class="line">* Buffer the request body and parse it according to the `Content-Type` header (usually `application/json` or `application/x-www-form-urlencoded`).</div><div class="line">* Stream the request body by manually calling `.pipe` or listening to the `data` and `end` events.</div><div class="line"></div><div class="line">By default `director.http.Router()` will attempt to parse either the `.chunks` or `.body` properties set on the request parameter passed to `router.dispatch(request, response, callback)`. The router instance will also wait for the `end` event before firing any routes.</div><div class="line"></div><div class="line">**Default Behavior**</div><div class="line"></div><div class="line">``` js</div><div class="line">  var director = require(&#39;director&#39;);</div><div class="line"></div><div class="line">  var router = new director.http.Router();</div><div class="line"></div><div class="line">  router.get(&#39;/&#39;, function () {</div><div class="line">    //</div><div class="line">    // This will not work, because all of the data</div><div class="line">    // events and the end event have already fired.</div><div class="line">    //</div><div class="line">    this.req.on(&#39;data&#39;, function (chunk) {</div><div class="line">      console.log(chunk)</div><div class="line">    });</div><div class="line">  });</div></div><!-- fragment --><p>In <a href="http://github.com/flatiron/flatiron">flatiron</a>, <code>director</code> is used in conjunction with <a href="http://github.com/flatiron/union">union</a> which uses a <code>BufferedStream</code> proxy to the raw <code>http.Request</code> instance. <a href="http://github.com/flatiron/union">union</a> will set the <code>req.chunks</code> property for you and director will automatically parse the body. If you wish to perform this buffering yourself directly with <code>director</code> you can use a simple request handler in your http server:</p>
<div class="fragment"><div class="line">var http = require(&#39;http&#39;),</div><div class="line">    director = require(&#39;director&#39;);</div><div class="line"></div><div class="line">var router = new director.http.Router();</div><div class="line"></div><div class="line">var server = http.createServer(function (req, res) {</div><div class="line">  req.chunks = [];</div><div class="line">  req.on(&#39;data&#39;, function (chunk) {</div><div class="line">    req.chunks.push(chunk.toString());</div><div class="line">  });</div><div class="line"></div><div class="line">  router.dispatch(req, res, function (err) {</div><div class="line">    if (err) {</div><div class="line">      res.writeHead(404);</div><div class="line">      res.end();</div><div class="line">    }</div><div class="line"></div><div class="line">    console.log(&#39;Served &#39; + req.url);</div><div class="line">  });</div><div class="line">});</div><div class="line"></div><div class="line">router.post(&#39;/&#39;, function () {</div><div class="line">  this.res.writeHead(200, { &#39;Content-Type&#39;: &#39;application/json&#39; })</div><div class="line">  this.res.end(JSON.stringify(this.req.body));</div><div class="line">});</div></div><!-- fragment --><p><b>Streaming Support</b></p>
<p>If you wish to get access to the request stream before the <code>end</code> event is fired, you can pass the <code>{ stream: true }</code> options to the route.</p>
<div class="fragment"><div class="line">var director = require(&#39;director&#39;);</div><div class="line"></div><div class="line">var router = new director.http.Router();</div><div class="line"></div><div class="line">router.get(&#39;/&#39;, { stream: true }, function () {</div><div class="line">  //</div><div class="line">  // This will work because the route handler is invoked</div><div class="line">  // immediately without waiting for the `end` event.</div><div class="line">  //</div><div class="line">  this.req.on(&#39;data&#39;, function (chunk) {</div><div class="line">    console.log(chunk);</div><div class="line">  });</div><div class="line">});</div></div><!-- fragment --><p><a class="anchor" id="instance-methods"></a> </p><h2>Instance methods</h2>
<h3>configure(options)</h3>
<ul>
<li><code>options</code> {<a class="el" href="struct_object.html">Object</a>}: Options to configure this instance with.</li>
</ul>
<p>Configures the Router instance with the specified <code>options</code>. See <a href="#configuration">Configuration</a> for more documentation.</p>
<h3>param(token, matcher)</h3>
<ul>
<li>token {string}: Named parameter token to set to the specified <code>matcher</code></li>
<li>matcher {string|Regexp}: Matcher for the specified <code>token</code>.</li>
</ul>
<p>Adds a route fragment for the given string <code>token</code> to the specified regex <code>matcher</code> to this Router instance. See <a href="#url-params">URL Parameters</a> for more documentation.</p>
<h3>on(method, path, route)</h3>
<ul>
<li><code>method</code> {string}: Method to insert within the Routing Table (e.g. <code>on</code>, <code>get</code>, etc.).</li>
<li><code>path</code> {string}: Path within the Routing Table to set the <code>route</code> to.</li>
<li><code>route</code> {function|Array}: Route handler to invoke for the <code>method</code> and <code>path</code>.</li>
</ul>
<p>Adds the <code>route</code> handler for the specified <code>method</code> and <code>path</code> within the <a href="#routing-table">Routing Table</a>.</p>
<h3>path(path, routesFn)</h3>
<ul>
<li><code>path</code> {string|Regexp}: Scope within the Routing Table to invoke the <code>routesFn</code> within.</li>
<li><code>routesFn</code> {function}: Adhoc Routing function with calls to <code>this.on()</code>, <code>this.get()</code> etc.</li>
</ul>
<p>Invokes the <code>routesFn</code> within the scope of the specified <code>path</code> for this Router instance.</p>
<h3>dispatch(method, path[, callback])</h3>
<ul>
<li>method {string}: Method to invoke handlers for within the Routing Table</li>
<li>path {string}: Path within the Routing Table to match</li>
<li>callback {function}: Invoked once all route handlers have been called.</li>
</ul>
<p>Dispatches the route handlers matched within the <a href="#routing-table">Routing Table</a> for this instance for the specified <code>method</code> and <code>path</code>.</p>
<h3>mount(routes, path)</h3>
<ul>
<li>routes {object}: Partial routing table to insert into this instance.</li>
<li>path {string|Regexp}: Path within the Routing Table to insert the <code>routes</code> into.</li>
</ul>
<p>Inserts the partial <a href="#routing-table">Routing Table</a>, <code>routes</code>, into the Routing Table for this Router instance at the specified <code>path</code>.</p>
<h2>Instance methods (Client-side only)</h2>
<h3>init([redirect])</h3>
<ul>
<li><code>redirect</code> {String}: This value will be used if '/#/' is not found in the URL. (e.g., init('/') will resolve to '/#/', init('foo') will resolve to '/<a class="el" href="namespacefoo.html">foo</a>').</li>
</ul>
<p>Initialize the router, start listening for changes to the URL.</p>
<h3>getRoute([index])</h3>
<ul>
<li><code>index</code> {Number}: <a class="el" href="protocol_the-p.html">The</a> hash value is divided by forward slashes, each section then has an index, if this is provided, only that section of the route will be returned.</li>
</ul>
<p>Returns the entire route or just a section of it.</p>
<h3>setRoute(route)</h3>
<ul>
<li><code>route</code> {String}: Supply a route value, such as <code>home/stats</code>.</li>
</ul>
<p>Set the current route.</p>
<h3>setRoute(start, length)</h3>
<ul>
<li><code>start</code> {Number} - <a class="el" href="protocol_the-p.html">The</a> position at which to start removing items.</li>
<li><code>length</code> {Number} - <a class="el" href="protocol_the-p.html">The</a> number of items to remove from the route.</li>
</ul>
<p>Remove a segment from the current route.</p>
<h3>setRoute(index, value)</h3>
<ul>
<li><code>index</code> {Number} - <a class="el" href="protocol_the-p.html">The</a> hash value is divided by forward slashes, each section then has an index.</li>
<li><code>value</code> {String} - <a class="el" href="protocol_the-p.html">The</a> new value to assign the the position indicated by the first parameter.</li>
</ul>
<p>Set a segment of the current route.</p>
<p><a class="anchor" id="faq"></a> </p><h1>Frequently Asked Questions</h1>
<h2>What About SEO?</h2>
<p>Is using a Client-side router a problem for SEO? Yes. If advertising is a requirement, you are probably building a "Web Page" and not a "Web Application". Director on the client is meant for script-heavy Web Applications.</p>
<h1>Licence</h1>
<p>(<a class="el" href="protocol_the-p.html">The</a> MIT License)</p>
<p>Copyright (c) 2010 Nodejitsu Inc. <a href="http://www.twitter.com/nodejitsu">http://www.twitter.com/nodejitsu</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p><a class="el" href="protocol_the-p.html">The</a> above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR <a class="el" href="struct_a.html">A</a> PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
