<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>webkit: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">webkit
   &#160;<span id="projectnumber">2cdf99a9e3038c7e01b3c37e8ad903ecbe5eecf1</span>
   </div>
   <div id="projectbrief">https://github.com/WebKit/webkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://promises-aplus.github.com/promises-spec"></a></p>
<h1>Promises/A+ Compliance <a class="el" href="struct_test.html">Test</a> Suite</h1>
<p>This suite tests compliance of a promise implementation with the <a href="https://github.com/promises-aplus/promises-spec">Promises/A+ specification</a>.</p>
<h2>How To Run</h2>
<p><a class="el" href="protocol_the-p.html">The</a> tests run in a Node.js environment; make sure you have that installed.</p>
<h3>Adapters</h3>
<p>In order to test your promise library, you must expose a very minimal adapter interface. These are written as Node.js modules with a few well-known exports:</p>
<ul>
<li><code>resolved(value)</code>: creates a promise that is resolved with <code>value</code>.</li>
<li><code>rejected(reason)</code>: creates a promise that is already rejected with <code>reason</code>.</li>
<li><code>deferred()</code>: creates an object consisting of <code>{ promise, resolve, reject }</code>:<ul>
<li><code>promise</code> is a promise that is currently in the pending state.</li>
<li><code>resolve(value)</code> resolves the promise with <code>value</code>.</li>
<li><code>reject(reason)</code> moves the promise from the pending state to the rejected state, with rejection reason <code>reason</code>.</li>
</ul>
</li>
</ul>
<p><a class="el" href="protocol_the-p.html">The</a> <code>resolved</code> and <code>rejected</code> exports are actually optional, and will be automatically created by the test runner using <code>deferred</code> if they are not present. But, if your promise library has the capability to create already-resolved or already-rejected promises, then you should include these exports, so that the test runner can provide you with better code coverage and uncover any bugs in those methods.</p>
<p>Note that the tests will never pass a promise or a thenable as a resolution. That means that we never use the promise- or thenable-accepting forms of the resolve operation directly, and instead only use the direct fulfillment operation, since fulfill and resolve are equivalent when not given a thenable.</p>
<p>Finally, note that none of these functions, including <code>deferred().resolve</code> and <code>deferred().reject</code>, should throw exceptions. <a class="el" href="protocol_the-p.html">The</a> tests are not structured to deal with that, and if your implementation has the potential to throw exceptions—e.g., perhaps it throws when trying to resolve an already-resolved promise—you should wrap direct calls to your implementation in <code>try</code>/<code>catch</code> when writing the adapter.</p>
<h3>From the CLI</h3>
<p>This package comes with a command-line interface that can be used either by installing it globally with <code>npm install promises-aplus-tests -g</code> or by including it in your <code>package.json</code>'s <code>devDependencies</code> and using npm's <code>scripts</code> feature. In the latter case, your setup might look something like</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;devDependencies&quot;: {</div><div class="line">        &quot;promises-aplus-tests&quot;: &quot;*&quot;</div><div class="line">    },</div><div class="line">    &quot;scripts&quot;: {</div><div class="line">        &quot;test&quot;: &quot;run-my-own-tests &amp;&amp; promises-aplus-tests test/my-adapter&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p><a class="el" href="protocol_the-p.html">The</a> CLI takes as its first argument the filename of your adapter file, relative to the current working directory. It tries to pass through any subsequent options to Mocha, so you can use e.g. <code>--reporter spec</code> or <code>--grep 2.2.4</code>.</p>
<h3>Programmatically</h3>
<p><a class="el" href="protocol_the-p.html">The</a> main export of this package is a function that allows you to run the tests against an adapter:</p>
<div class="fragment"><div class="line">var promisesAplusTests = require(&quot;promises-aplus-tests&quot;);</div><div class="line"></div><div class="line">promisesAplusTests(adapter, function (err) {</div><div class="line">    // All done; output is in the console. Or check `err` for number of failures.</div><div class="line">});</div></div><!-- fragment --><p>You can also pass any Mocha options as the second parameter, e.g.</p>
<div class="fragment"><div class="line">promisesAplusTests(adapter, { reporter: &quot;dot&quot; }, function (err) {</div><div class="line">  // As before.</div><div class="line">});</div></div><!-- fragment --><h3>Within an Existing Mocha <a class="el" href="struct_test.html">Test</a> Suite</h3>
<p>If you already have a Mocha test suite and want to include these tests in it, you can do:</p>
<div class="fragment"><div class="line">describe(&quot;Promises/A+ Tests&quot;, function () {</div><div class="line">    require(&quot;promises-aplus-tests&quot;).mocha(adapter);</div><div class="line">});</div></div><!-- fragment --><p>This only works in Node.js, however. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
